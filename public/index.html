<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>آخرین پست‌های ابوالفضل شهاب | ivan.omgru | Иван омгру</title>
<meta name="description" content="آخرین پست‌های اینستاگرام و ویدیوهای یوتیوب ابوالفضل شهاب | ivan.omgru | Иван омгру">
<meta name="keywords" content="ivan.omgru, Иван омгру, ابوالفضل شهاب, آموزش آنلاین, ویدیو آموزشی, Instagram, YouTube">
<meta name="author" content="ابوالفضل شهاب | ivan.omgru | Иван омгру">

<!-- Favicon -->
<link rel="icon" href="https://media.ivan.omgru.ir/images/logo.png" type="image/png">

<!-- Open Graph / Twitter Card -->
<meta property="og:title" content="آخرین پست‌های ابوالفضل شهاب | ivan.omgru | Иван омгру">
<meta property="og:description" content="آخرین پست‌های اینستاگرام و ویدیوهای یوتیوب ابوالفضل شهاب | ivan.omgru | Иван омгру">
<meta property="og:type" content="website">
<meta property="og:url" content="https://ivan.omgru.ir/">
<meta property="og:image" content="https://media.ivan.omgru.ir/images/logo.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="آخرین پست‌های ابوالفضل شهاب | ivan.omgru | Иван омгру">
<meta name="twitter:description" content="آخرین پست‌های اینستاگرام و ویدیوهای یوتیوب ابوالفضل شهاب | ivan.omgru | Иван омгру">
<meta name="twitter:image" content="https://media.ivan.omgru.ir/images/profile.jpg">

<!-- Preload Fonts & CSS -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Vazir&display=swap" as="style">
<!-- Swiper CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Vazir&display=swap">

<!-- JSON-LD دو زبانه -->
<style>
/* =========================
   پایه و ریست
========================= */
* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Vazir', sans-serif; }
body { color: #fff; line-height: 1.6; position: relative; z-index: 1; background: #000; overflow-x: hidden; }
a { text-decoration: none; color: inherit; }
img, video { display: block; max-width: 100%; height: auto; }

/* =========================
   هدر
========================= */
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: clamp(15px,2vw,30px);
  background: transparent;
  position: relative;
  flex-wrap: wrap;
  z-index: 2;
}
header h1 {
  font-size: clamp(1.5rem, 2vw + 1rem, 2.5rem);
  margin-bottom: 0.5em;
  text-shadow: 0 2px 6px rgba(0,0,0,0.7);
}
.lang-switch button {
  margin-left: 10px;
  padding: 6px 12px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  background: #fff;
  color: #007bff;
  font-weight: bold;
  font-size: clamp(0.8rem,1vw+0.5rem,1rem);
  transition: background 0.3s, color 0.3s, transform 0.2s;
}
.lang-switch button:hover {
  background: #007bff;
  color: #fff;
  transform: scale(1.05);
}

/* =========================
   کانتینر و عنوان بخش‌ها
========================= */
.container {
  max-width: 1200px;
  margin: 50px auto;
  padding: 0 15px;
  position: relative;
  z-index: 2;
}
.section-title {
  margin-bottom: 25px;
  font-size: clamp(1.2rem,2vw+1rem,1.8rem);
  color: #00d4ff;
  text-align: center;
  text-shadow: 0 2px 6px rgba(0,0,0,0.7);
  transition: color 0.3s;
}

/* =========================
   گرید واکنش‌گرا برای کارت‌ها
========================= */
.grid {
  display: grid;
  gap: 15px;
}
@media (min-width: 1400px) { .grid { grid-template-columns: repeat(5,1fr); } }
@media (min-width: 1200px) and (max-width: 1399px) { .grid { grid-template-columns: repeat(4,1fr); } }
@media (min-width: 768px) and (max-width: 1199px) { .grid { grid-template-columns: repeat(3,1fr); } }
@media (max-width: 767px) { .grid { grid-template-columns: repeat(2,1fr); } }

/* =========================
   Hover و افکت حرفه‌ای Swiper و Media-Card
========================= */
.swiper-slide {
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 25px rgba(0,0,0,0.4);
  transition: transform 0.5s ease, box-shadow 0.5s ease;
}
.swiper-slide:hover {
  transform: scale(1.08) rotateY(5deg);
  box-shadow: 0 15px 35px rgba(0,0,0,0.6);
}
.media-card:hover {
  transform: translateY(-8px) scale(1.03);
  box-shadow: 0 15px 40px rgba(0,0,0,0.7);
}

/* =========================
   مدیریت زبان‌ها
========================= */
.lang-fa { display: block; }
.lang-ru { display: none; }

/* =========================
   فوتر
========================= */
footer {
  text-align: center;
  margin: 50px 0;
  color: #ccc;
  font-size: clamp(0.7rem,1vw+0.3rem,0.95rem);
  position: relative;
  z-index: 2;
}

/* =========================
   ویدیو پس‌زمینه
========================= */
.video-background {
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  z-index: 0;
  background: #000;
}
.video-background video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  position: absolute;
  top: 0; left: 0;
  z-index: 0;
  transition: filter 0.3s;
  filter: brightness(0.7);
}
.video-background .overlay {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.3);
  z-index: 1;
}

/* =========================
   واکنش‌گرایی موبایل و تبلت
========================= */
@media (max-width: 1024px) {
  header h1 { font-size: clamp(1.4rem,2vw+1rem,2rem); }
  .swiper-slide { min-width: 220px; }
  .media-card p { font-size: 0.85rem; }
}
@media (max-width: 768px) {
  header { flex-direction: column; align-items: center; text-align: center; }
  header h1 { font-size: clamp(1.2rem,2vw+1rem,1.8rem); }
  .lang-switch { margin-top: 10px; }
  .swiper-slide { min-width: 90%; margin: 0 auto; }
}
</style>
</head>
<body>

<div class="video-background">
  <video autoplay muted loop playsinline>
    <source src="media/background.mp4" type="video/mp4">
    مرورگر شما از ویدیو پشتیبانی نمی‌کند.
  </video>
  <div class="overlay"></div>
</div>

<header>
  <h1 class="lang-fa">آخرین پست‌ها و ویدیوهای ابوالفضل شهاب | ivan.omgru | Иван омгру</h1>
  <h1 class="lang-ru">Последние посты в Instagram и видео на YouTube Абульфазля Шахаба | ivan.omgru | Иван омгру</h1>
  <div class="lang-switch">
    <button onclick="setLanguage('fa')">فارسی</button>
    <button onclick="setLanguage('ru')">Русский</button>
  </div>
</header>

<div class="container">
  <h2 class="section-title lang-fa">اسلایدر اینستاگرام ivan.omgru / Иван омгру</h2>
  <h2 class="section-title lang-ru">Слайдер Instagram ivan.omgru / Иван омгру</h2>
  <div class="swiper instagram-swiper">
    <div class="swiper-wrapper instagram-carousel"></div>
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
  </div>

  <h2 class="section-title lang-fa">اسلایدر ویدیوهای یوتیوب ivan.omgru / Иван омгру</h2>
  <h2 class="section-title lang-ru">Слайдер видео YouTube ivan.omgru / Иван омгру</h2>
  <div class="swiper youtube-swiper">
    <div class="swiper-wrapper youtube-carousel"></div>
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
  </div>

  <h2 class="section-title lang-fa">تمام پست‌ها و ویدیوها</h2>
  <h2 class="section-title lang-ru">Все посты и видео</h2>
  <div class="grid instagram-gallery"></div>
  <div class="grid youtube-gallery"></div>

</div>

<footer>
  <span class="lang-fa">© 2025 ابوالفضل شهاب | ivan.omgru | Иван омгру</span>
  <span class="lang-ru">© 2025 Абульфазль Шахаб | ivan.omgru | Иван омгру</span>
</footer>
<!-- Swiper JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
<script>
/* =========================
   مدیریت زبان دو زبانه با افکت
========================= */
function setLanguage(lang) {
    document.querySelectorAll('.lang-fa').forEach(e => {
        e.style.transition = "opacity 0.3s";
        e.style.opacity = lang === 'fa' ? '1' : '0';
        setTimeout(() => e.style.display = lang === 'fa' ? 'block' : 'none', 300);
    });
    document.querySelectorAll('.lang-ru').forEach(e => {
        e.style.transition = "opacity 0.3s";
        e.style.opacity = lang === 'ru' ? '1' : '0';
        setTimeout(() => e.style.display = lang === 'ru' ? 'block' : 'none', 300);
    });
    localStorage.setItem('siteLanguage', lang);
}
document.addEventListener('DOMContentLoaded', () => {
    setLanguage(localStorage.getItem('siteLanguage') || 'fa');
});

/* =========================
   کش با انقضا
========================= */
function setCache(key, data, ttl = 86400000) {
    const record = { data, expires: Date.now() + ttl };
    localStorage.setItem(key, JSON.stringify(record));
}
function getCache(key) {
    const record = JSON.parse(localStorage.getItem(key) || "{}");
    if (!record || Date.now() > record.expires) return null;
    return record.data;
}

/* =========================
   ایجاد Swiper با breakpoints
========================= */
function createProSwiper(selector) {
  return new Swiper(selector, {
    slidesPerView: 1,
    spaceBetween: 20,
    loop: true,
    effect: 'coverflow',
    coverflowEffect: {
      rotate: 30,
      stretch: 0,
      depth: 150,
      modifier: 1,
      slideShadows: true,
    },
    navigation: {
      nextEl: `${selector} .swiper-button-next`,
      prevEl: `${selector} .swiper-button-prev`
    },
    breakpoints: {
      0: { slidesPerView: 3 },
      768: { slidesPerView: 4 },
      1024: { slidesPerView: 5 },
    },
    lazy: true,
    grabCursor: true,
    centeredSlides: true,
    speed: 800
  });
}

const instaSwiper = createProSwiper('.instagram-swiper');
const ytSwiper = createProSwiper('.youtube-swiper');

/* =========================
   ایجاد کارت‌ها
========================= */
function createSlideCard(link, imgSrc, captionFa, captionRu, icon) {
    return `
    <div class="swiper-slide">
        <a href="${link}" target="_blank" rel="noopener noreferrer">
            <img data-src="${imgSrc}" alt="${captionFa}" class="lazy">
            <div class="overlay-icon">${icon}</div>
            <p class="lang-fa">${captionFa}</p>
            <p class="lang-ru">${captionRu}</p>
        </a>
    </div>`;
}

function createGridCard(link, imgSrc, captionFa, captionRu) {
    return `
    <div class="media-card">
        <a href="${link}" target="_blank" rel="noopener noreferrer">
            <img data-src="${imgSrc}" alt="${captionFa}" class="lazy">
            <p class="lang-fa">${captionFa}</p>
            <p class="lang-ru">${captionRu}</p>
        </a>
    </div>`;
}

/* =========================
   Lazy load تصاویر و ویدیوها
========================= */
function lazyLoad(selector) {
    const imgs = document.querySelectorAll(selector);
    const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.src = img.dataset.src;
                obs.unobserve(img);
            }
        });
    }, { rootMargin: "100px" });
    imgs.forEach(img => observer.observe(img));
}

function lazyLoadVideos(selector) {
    const videos = document.querySelectorAll(selector);
    const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
            if(entry.isIntersecting) {
                const video = entry.target;
                const source = video.querySelector('source');
                source.src = source.dataset.src;
                video.load();
                obs.unobserve(video);
            }
        });
    }, { rootMargin: "100px" });
    videos.forEach(video => observer.observe(video));
}

/* =========================
   JSON-LD اتوماتیک دو زبانه
========================= */
function generateJSONLD(instaData, ytData) {
    const person = {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "ابوالفضل شهاب",
        "alternateName": "Абульфазль Шахаб",
        "url": "https://ivan.omgru.ir/",
        "sameAs": [
            "https://www.instagram.com/ivan.omgru/",
            "https://www.youtube.com/@ivanomgru"
        ],
        "image": "https://media.ivan.omgru.ir/images/profile.jpg",
        "jobTitle": "مدرس زبان روسی، طراح سایت، تولیدکننده محتوا",
        "description": "آخرین پست‌های اینستاگرام و ویدیوهای یوتیوب ابوالفضل شهاب | ivan.omgru | Иван омгру"
    };

    const website = {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "ivan.omgru | Иван омгру",
        "url": "https://ivan.omgru.ir/",
        "publisher": person
    };

    const instagramPosts = (instaData?.data || []).map(item => ({
        "@type": "ImageObject",
        "name": (item.caption?.slice(0,80) || "") + "… - پست اینستاگرام ابوالفضل شهاب",
        "url": item.permalink,
        "contentUrl": item.media_url
    }));

    const youtubeVideos = (ytData?.items || []).map(item => ({
        "@type": "VideoObject",
        "name": item.snippet.title.slice(0,80) + "… - ویدیو یوتیوب ابوالفضل شهاب",
        "url": `https://www.youtube.com/watch?v=${item.id.videoId}`,
        "thumbnailUrl": item.snippet.thumbnails.high.url,
        "uploadDate": item.snippet.publishedAt,
        "publisher": person
    }));

    const jsonLD = [person, website, ...instagramPosts, ...youtubeVideos];

    // اضافه کردن به head به صورت داینامیک
    if (!document.head.querySelector('script[type="application/ld+json"]')) {
        const scriptTag = document.createElement('script');
        scriptTag.type = 'application/ld+json';
        scriptTag.text = JSON.stringify(jsonLD, null, 2);
        document.head.appendChild(scriptTag);
    } else {
        // به روز رسانی اگر قبلاً وجود داشته
        const existing = document.head.querySelector('script[type="application/ld+json"]');
        existing.text = JSON.stringify(jsonLD, null, 2);
    }
}

/* =========================
   اجرا در DOMContentLoaded
========================= */
document.addEventListener('DOMContentLoaded', () => {
    loadMediaData();
    lazyLoadVideos('video.lazy-video'); // اگر ویدیو دارید
});
// =========================
// دریافت داده‌ها از سرور امن و ساخت JSON-LD حرفه‌ای
// =========================
async function loadMediaData() {
    const instaRes = await fetch('/api/instagram');
    const instaData = await instaRes.json();

    const ytRes = await fetch('/api/youtube');
    const ytData = await ytRes.json();

    // پاک کردن گالری‌ها قبل از اضافه کردن
    const instaGallery = document.querySelector('.instagram-gallery');
    const ytGallery = document.querySelector('.youtube-gallery');
    instaGallery.innerHTML = '';
    ytGallery.innerHTML = '';

    // آرایه‌ها برای JSON-LD
    const instagramPosts = [];
    const youtubeVideos = [];

    // اضافه کردن عکس‌ها و جمع‌آوری برای JSON-LD
    (instaData.data || []).forEach(item => {
        const img = document.createElement('img');
        img.src = item.media_url;
        img.alt = item.caption || "پست اینستاگرام ابوالفضل شهاب";
        instaGallery.appendChild(img);

        instagramPosts.push({
            "@type": "ImageObject",
            "name": (item.caption?.slice(0,80) || "") + "… - پست اینستاگرام ابوالفضل شهاب",
            "url": item.permalink,
            "contentUrl": item.media_url
        });
    });

    // اضافه کردن ویدیوها و جمع‌آوری برای JSON-LD
    (ytData.items || []).forEach(item => {
        const videoLink = `https://www.youtube.com/watch?v=${item.id.videoId}`;
        const thumb = item.snippet.thumbnails.high.url;

        const img = document.createElement('img');
        img.src = thumb;
        img.alt = item.snippet.title || "ویدیو یوتیوب ابوالفضل شهاب";
        ytGallery.appendChild(img);

        youtubeVideos.push({
            "@type": "VideoObject",
            "name": item.snippet.title.slice(0,80) + "… - ویدیو یوتیوب ابوالفضل شهاب",
            "url": videoLink,
            "thumbnailUrl": thumb,
            "uploadDate": item.snippet.publishedAt,
            "publisher": {
                "@type": "Person",
                "name": "ابوالفضل شهاب",
                "alternateName": "Абульфазль Шахаб",
                "url": "https://ivan.omgru.ir/"
            }
        });
    });

    // ساخت JSON-LD نهایی
    const jsonLD = {
        "@context": "https://schema.org",
        "@graph": [
            {
                "@type": "Person",
                "name": "ابوالفضل شهاب",
                "alternateName": "Абульфазль Шахаб",
                "url": "https://ivan.omgru.ir/",
                "sameAs": [
                    "https://www.instagram.com/ivan.omgru/",
                    "https://www.youtube.com/@ivanomgru"
                ],
                "image": "https://media.ivan.omgru.ir/images/profile.jpg",
                "jobTitle": "مدرس زبان روسی، طراح سایت، تولیدکننده محتوا",
                "description": "آخرین پست‌های اینستاگرام و ویدیوهای یوتیوب ابوالفضل شهاب | ivan.omgru | Иван омгру"
            },
            ...instagramPosts,
            ...youtubeVideos
        ]
    };

    // اضافه کردن یا به‌روز رسانی script JSON-LD
    let scriptTag = document.head.querySelector('script[type="application/ld+json"]');
    if (!scriptTag) {
        scriptTag = document.createElement('script');
        scriptTag.type = 'application/ld+json';
        document.head.appendChild(scriptTag);
    }
    scriptTag.textContent = JSON.stringify(jsonLD, null, 2);
}

</script>
</body>
</html>

